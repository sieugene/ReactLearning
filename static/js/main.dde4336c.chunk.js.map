{"version":3,"sources":["redux/UsersPage-Reducer.js","assets/preloader/preloader.svg","Components/GlobalErrors/GlobalErrors.module.css","Components/Dialogs/Dialogs.module.css","assets/preloader/Preloader.jsx","assets/FormControl/FormsControls.jsx","Components/Profile/ProfileDataForm.jsx","Components/Profile/ProfileStatusWithHooks.jsx","Components/Profile/ProfileData.jsx","Components/Profile/Profile.jsx","redux/ProfilePage-Reducer.js","Components/Profile/ProfileContainer.jsx","Components/Sidebar/SIdebar.jsx","Components/Header/DropDownNavbar.js","Components/Header/Header.jsx","redux/Auth-Reducer.ts","redux/App-Reducer.ts","Components/Header/HeaderContainer.jsx","Components/utils/validators/validators.js","Components/Login/Login.jsx","Components/Login/LoginContainer.jsx","Components/SecondSidebar/SecondSidebar.jsx","Components/Dialogs/Dialog.jsx","Components/Dialogs/Dialogs.jsx","redux/Dialogs-Reducer.ts","Components/Dialogs/DialogsContainer.jsx","Components/Dialogs/MessageForm.js","Components/Dialogs/Messages.jsx","Components/Dialogs/MessagesContainer.jsx","Components/GlobalErrors/GlobalErrors.js","App.js","serviceWorker.js","redux/store-redux.js","index.js","Components/Profile/Profile.module.css","assets/FormControl/FormsControls.module.css","assets/images/userPhoto.png","Components/Sidebar/Sidebar.module.css","Components/Header/Header.module.css","assets/preloader/preloader.module.css","Api/Api.js"],"names":["initialState","UsersList","pageSize","totalUsers","currentPage","searchTerm","isFetching","followingInProgress","followAC","userId","type","unFollowAC","setUsersAC","setUsersTotalCount","setSearchTermAC","text","toggleIsFetchingAC","toggleFollowingInProgressAC","getUsersThunkCreator","dispatch","a","UsersAPI","getUsers","response","items","totalCount","setCurrentPageThunkCreator","pageNumber","setSearchTermTextThunkCreator","getUsersTerm","followUnfollowFlow","methoApi","action","unFollowUserThunkCreator","FollowAPI","unfollowUser","followUserThunkCreator","followUser","UsersPageReducer","state","map","u","id","followed","filter","module","exports","Preloader","props","className","s","preloadContain","src","preloadImg","preloader","alt","InputMessage","input","meta","activeError","touched","error","FormControl","InputAuth","Contact","contactTitle","contactBody","href","target","rel","Field","placeholder","name","component","ReduxEditProfile","reduxForm","form","infoProfile","onSubmit","handleSubmit","someError","Object","keys","profile","contacts","key","ProfileStatusWithHooks","React","memo","useState","editMode","setEditMode","status","setStatus","activateEditMode","deactivateEditMode","updateStatusUserThunk","onChangeTextStatus","e","currentTarget","value","useEffect","Number","urlMatchParams","onChange","autoFocus","onBlur","onDoubleClick","data-tooltip","ProfileData","editButton","onClick","setEditProfile","aboutMe","fullName","lookingForAJob","lookingForAJobDescription","Profile","editProfile","profileContain","loading","avatarBlock","photos","small","large","userPhoto","files","length","uploadNewPhotoThunk","htmlFor","uploadPhoto","initialValues","formData","updateProfileUserThunk","then","setUserProfileAC","setStatusUserAC","uploadNewPhotoAC","setLoadingAC","getProfileThunkCreator","ProfileAPI","getProfile","data","profilePageReducer","ProfileContainer","this","getProfileThunk","setStatusUserThunk","match","params","updateProfile","prevProps","prevState","snapshot","path","to","Component","compose","connect","profilePage","Auth","setUser","getStatus","newStatus","updateStatus","resultCode","alert","getState","messageError","messages","stopSubmit","_error","Promise","reject","withRouter","Sidebar","sidebar","activeClassName","active","logoutThunk","loginButton","DropDownNavbar","addClassForToggle","toggle","Header","cursor","dropDownToogle","isAuth","login","userlink","email","captcha","setAuthUserAC","toogleLoadingAC","authMeThunkCreator","meAPI","me","getCaptchaThunkCreator","securityAPI","getCaptcha","url","authReducer","initialized","initializedUserPhotoAC","HeaderContainer","setState","initiliazedUserPhotoThunk","location","pathname","bind","app","logout","promise","required","ReduxLoginForm","validate","Login","loginThunk","password","rememberMe","LoginContainer","getCaptchaThunk","SecondSidebar","Dialog","lastDataActivity","dialog","lastDialogActivityDate","lastDataActivShort","substr","userName","newMessagesCount","Dialogs","listDialogs","messagesWithFriend","countNesMessages","currentUserInChat","setMessagesListWithFriendAC","setSuccessLoadingAC","getListMessagesWithFriendThunkCreator","DialogsAPI","getListMessagesWithFriend","all","values","syncMessagesWithFrinedThunkCreator","console","log","sendMessageToFriendThunkCreator","newMessage","sendMessageToFriend","DialogsReducer","allDialogs","dialogs","startChattingThunk","startChatting","getAllDialogsThunk","getAllDialogs","getListMessagesWithFriendThunk","sendMessageToFriendThunk","getListNewMessagesThunk","listNewMessage","ReduxMessageForm","container","Messages","regEx","getCurrentUserPhoto","getUserPhoto","authUserPhoto","messagesContain","chatTittle","mainChatBlock","chatBody","past__messages","getReturnMessageDateThunk","m","viewed","messagesWithFriendId","notViewedMessage","main__img__username","senderId","senderName","dateAdded","date","result","replace","split","addedAt","chatText","body","MessagesContainer","load","ClearIntreval","SyncInterval","returnMessageThanDate","syncMessagesWithFrinedThunk","GlobalErrors","catchAllUnhandelErrors","promiseRejectionEvent","globalErrors","reason","message","request","setTimeout","window","addEventListener","error_window","UsersContainer","lazy","App","initiliazedThunk","userIdi","timerID","setInterval","clearInterval","render","fallback","exact","Boolean","hostname","reducers","combineReducers","userPage","formReducer","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","store","createStore","applyMiddleware","thunkMiddleware","ReactDOM","basename","process","document","getElementById","navigator","serviceWorker","ready","registration","unregister","instance","axios","withCredentials","baseURL","headers","get","put","FormData","append","post","delete","isViewedYourMessage","messageId","messageInSpam","deleteMessage","restoreMessage"],"mappings":"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","file":"static/js/main.dde4336c.chunk.js","sourcesContent":["import {FollowAPI, UsersAPI} from \"../Api/Api\";\r\n\r\nconst FOLLOW = 'FOLLOW';\r\nconst UNFOLLOW = 'UNFOLLOW';\r\nconst SET_USERS = 'SET_USERS';\r\nconst SET_CURRENT_PAGE = 'SET_CURRENT_PAGE';\r\nconst SET_USERS_TOTAL_COUNT = 'SET_USERS_TOTAL_COUNT';\r\nconst SET_SEARCH_TERM = 'SET_SEARCH_TERM';\r\nconst TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING';\r\nconst TOGGLE_FOLLOWING_PROGRESS = 'TOGGLE_FOLLOWING_PROGRESS'\r\n\r\n\r\nlet initialState = {\r\n    UsersList: [],\r\n    pageSize: 15,\r\n    totalUsers: 0,\r\n    currentPage: 1,\r\n    searchTerm: '',\r\n    isFetching: false,\r\n    followingInProgress: []\r\n}\r\n\r\nconst UsersPageReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case FOLLOW:\r\n            return {\r\n                ...state,\r\n                UsersList: state.UsersList.map(u => {\r\n                    if (u.id === action.userId) {\r\n                        return {...u, followed: true}\r\n                    }\r\n                    return u\r\n                })\r\n            }\r\n        case UNFOLLOW:\r\n            return {\r\n                ...state,\r\n                UsersList: state.UsersList.map(u => {\r\n                    if (u.id === action.userId) {\r\n                        return {...u, followed: false}\r\n                    }\r\n                    return u\r\n                })\r\n            }\r\n        case SET_USERS:\r\n            return {\r\n                ...state,\r\n                UsersList: action.UsersList,\r\n            }\r\n        case SET_CURRENT_PAGE:\r\n            return {\r\n                ...state,\r\n                currentPage: action.currentPage\r\n            }\r\n        case SET_USERS_TOTAL_COUNT:\r\n            return {\r\n                ...state,\r\n                totalUsers: action.totalUsers\r\n            }\r\n        case SET_SEARCH_TERM:\r\n            return {\r\n                ...state,\r\n                searchTerm: action.text\r\n            }\r\n        case TOGGLE_IS_FETCHING:\r\n            return {\r\n                ...state,\r\n                isFetching: action.isFetching\r\n            }\r\n        case TOGGLE_FOLLOWING_PROGRESS:\r\n            return {\r\n                ...state,\r\n                followingInProgress: action.isFetching ?\r\n                    [...state.followingInProgress, action.userId]\r\n                    :\r\n                    state.followingInProgress.filter(id => id !== action.userId)\r\n            }\r\n        default:\r\n            return state\r\n\r\n    }\r\n}\r\n\r\nexport const followAC = (userId) => {\r\n    return {\r\n        type: FOLLOW, userId\r\n    }\r\n}\r\nexport const unFollowAC = (userId) => {\r\n    return {\r\n        type: UNFOLLOW, userId\r\n    }\r\n}\r\nexport const setUsersAC = (UsersList) => {\r\n    return {\r\n        type: SET_USERS, UsersList\r\n    }\r\n}\r\nexport const setCurrentPageAC = (currentPage) => {\r\n    return {\r\n        type: SET_CURRENT_PAGE, currentPage\r\n    }\r\n}\r\nexport const setUsersTotalCount = (totalUsers) => {\r\n    return {\r\n        type: SET_USERS_TOTAL_COUNT, totalUsers\r\n    }\r\n}\r\nexport const setSearchTermAC = (text) => {\r\n    return {\r\n        type: SET_SEARCH_TERM, text\r\n    }\r\n}\r\nexport const toggleIsFetchingAC = (isFetching) => {\r\n    return {\r\n        type: TOGGLE_IS_FETCHING, isFetching\r\n    }\r\n}\r\nexport const toggleFollowingInProgressAC = (isFetching, userId) => {\r\n    return {\r\n        type: TOGGLE_FOLLOWING_PROGRESS,\r\n        isFetching, userId\r\n    }\r\n}\r\n\r\nexport const getUsersThunkCreator = (pageSize, currentPage) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleIsFetchingAC(true));\r\n        let response = await UsersAPI.getUsers(pageSize, currentPage)\r\n        dispatch(toggleIsFetchingAC(false));\r\n        dispatch(setUsersAC(response.items));\r\n        dispatch(setUsersTotalCount(response.totalCount));\r\n    }\r\n}\r\n\r\nexport const setCurrentPageThunkCreator = (pageSize, pageNumber) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleIsFetchingAC(true));\r\n        dispatch(setCurrentPageAC(pageNumber));\r\n        let response = await UsersAPI.getUsers(pageSize, pageNumber)\r\n        dispatch(toggleIsFetchingAC(false));\r\n        dispatch(setUsersAC(response.items));\r\n        dispatch(setUsersTotalCount(response.totalCount));\r\n    }\r\n}\r\n\r\nexport const setSearchTermTextThunkCreator = (pageSize, text) => {\r\n    return async (dispatch) => {\r\n        dispatch(toggleIsFetchingAC(true));\r\n        dispatch(setSearchTermAC(text));\r\n        if(!text){\r\n            text = ' ';\r\n        }\r\n        let response = await UsersAPI.getUsersTerm(pageSize, text)\r\n        dispatch(toggleIsFetchingAC(false));\r\n        dispatch(setUsersAC(response.items));\r\n        dispatch(setUsersTotalCount(response.totalCount));\r\n    }\r\n}\r\n\r\n\r\nconst followUnfollowFlow = async (dispatch, userId, methoApi, action) => {\r\n    dispatch(toggleFollowingInProgressAC(true, userId))\r\n    await methoApi(userId)\r\n    dispatch(action(userId));\r\n    dispatch(toggleFollowingInProgressAC(false, userId));\r\n}\r\n\r\n\r\nexport const unFollowUserThunkCreator = (userId) => (dispatch) => {\r\n    return followUnfollowFlow(dispatch, userId, FollowAPI.unfollowUser, unFollowAC)\r\n}\r\n\r\n\r\nexport const followUserThunkCreator = (userId) => (dispatch) => {\r\n    return followUnfollowFlow(dispatch, userId, FollowAPI.followUser, followAC)\r\n}\r\n\r\n\r\nexport default UsersPageReducer;","module.exports = __webpack_public_path__ + \"static/media/preloader.03527c20.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"error_window\":\"GlobalErrors_error_window__AJulT\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"containerDialog\":\"Dialogs_containerDialog__3Vbal\",\"listDialogs\":\"Dialogs_listDialogs__19fS5\",\"dialogUser\":\"Dialogs_dialogUser__22E2c\",\"userNameWithImg\":\"Dialogs_userNameWithImg__MjVFY\",\"messagesContain\":\"Dialogs_messagesContain__OC50C\",\"NotViews\":\"Dialogs_NotViews__1RKFo\",\"messagesWithFriendId\":\"Dialogs_messagesWithFriendId__93Jwe\",\"dialog\":\"Dialogs_dialog__3kBaR\",\"notViewedMessage\":\"Dialogs_notViewedMessage__1_mXW\",\"main__img__username\":\"Dialogs_main__img__username__35j4I\",\"dateAdded\":\"Dialogs_dateAdded__15bT1\",\"chatText\":\"Dialogs_chatText__2f55I\",\"mainChatBlock\":\"Dialogs_mainChatBlock__1iniB\",\"chatTittle\":\"Dialogs_chatTittle__10pAG\",\"chatBody\":\"Dialogs_chatBody__QIwhv\",\"past__messages\":\"Dialogs_past__messages__2mXG7\"};","import React from 'react';\r\nimport preloadImg from './preloader.svg'\r\nimport s from './preloader.module.css';\r\n\r\nlet Preloader = (props) => {\r\n    return (\r\n        <div className={s.preloadContain}>\r\n            <img src={preloadImg} className={s.preloader} alt=''/>\r\n        </div>\r\n    )\r\n}\r\nexport default Preloader;","import React from \"react\";\r\nimport s from './FormsControls.module.css';\r\n\r\nexport const InputMessage = ({input, meta, ...props}) => {\r\n    let activeError = meta.touched && meta.error ? s.error : ' ';\r\n    return (\r\n        <div className={s.FormControl}>\r\n            <div className={activeError}>\r\n                <input {...input} {...props} /><br/>\r\n                {meta.touched && meta.error && <span>{meta.error}</span>}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\nexport const InputAuth = ({input, meta, ...props}) => {\r\n    let activeError = meta.touched && meta.error ? s.error : ' ';\r\n    return (\r\n        <div className={s.FormControl}>\r\n            <div className={activeError}>\r\n                <input {...input} {...props} /><br/>\r\n                {meta.touched && meta.error && <span>{meta.error}</span>}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\nexport const InputSearch = ({input, meta, ...props}) => {\r\n    let activeError = meta.touched && meta.error ? s.error : ' ';\r\n    return (\r\n        <div className={s.FormControl}>\r\n            <div className={activeError}>\r\n                <input {...input} {...props} /><br/>\r\n                {meta.touched && meta.error && <span>{meta.error}</span>}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\n","import React from 'react';\r\nimport {Field, reduxForm} from \"redux-form\";\r\nimport {InputMessage} from \"../../assets/FormControl/FormsControls\";\r\nimport s from \"./Profile.module.css\";\r\n\r\nconst ProfileDataForm = (props) => {\r\n    return (\r\n        <div className={s.infoProfile}>\r\n            <form onSubmit={props.handleSubmit}>\r\n                <button className='waves-effect waves-light btn-small indigo darken-4 mb10'>Save</button>\r\n                {props.error &&\r\n                    <div className={s.someError}>\r\n                        {props.error}\r\n                    </div>\r\n                }\r\n                <br/>\r\n                <span><b>About me:</b></span>\r\n                <Field placeholder='About me' name='aboutMe' component={InputMessage}/>\r\n                <span><b>Full name: </b></span>\r\n                <Field placeholder='Full Name' name='fullName' component={InputMessage}/>\r\n                <span><b>Seek work: </b></span>\r\n                <Field placeholder='Looking for a job' type=\"checkbox\" name='lookingForAJob' component={InputMessage}/>\r\n                <span><b>Description of the search: </b></span>\r\n                <Field placeholder='Looking for a job desc' name='lookingForAJobDescription' component={InputMessage}/>\r\n                {Object.keys(props.profile.contacts).map(key =>\r\n                    <Contact key={key} contactTitle={key} contactBody={''}/>\r\n                )}\r\n            </form>\r\n        </div>\r\n    )\r\n}\r\nconst Contact = ({contactTitle, contactBody}) => {\r\n    return (\r\n        <div>\r\n             <span>\r\n                <b>{contactTitle}: </b>\r\n                    <p>\r\n                        <a href={contactBody} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                            {contactBody}\r\n                        </a>\r\n                    </p>\r\n            </span>\r\n            <Field placeholder={`https://www.${contactTitle}.com`}\r\n                   name={`contacts.${contactTitle}`} component={InputMessage}/>\r\n        </div>\r\n    )\r\n}\r\nconst ReduxEditProfile = reduxForm({form: 'editProfile'})(ProfileDataForm)\r\n\r\nexport default ReduxEditProfile;\r\n","import React, {useEffect, useState} from 'react';\r\n\r\nconst ProfileStatusWithHooks = React.memo(props => {\r\n\r\n    let [editMode, setEditMode] = useState(false);\r\n    let [status, setStatus] = useState(props.status);\r\n\r\n    const activateEditMode = () => {\r\n        setEditMode(true);\r\n    }\r\n    const deactivateEditMode = () => {\r\n        setEditMode(false);\r\n        props.updateStatusUserThunk(props.id, status)\r\n    }\r\n    let onChangeTextStatus = (e) => {\r\n        setStatus(e.currentTarget.value);\r\n    }\r\n    //сохранение значения поля статуса при переходах.\r\n    //вместо componentDidUpdate\r\n    useEffect(() => {\r\n        setStatus(props.status)\r\n    },[props.status]);\r\n    //строка , [props.status], означает Перезапускать эффект только если props.status поменялся\r\n\r\n    const withEditStatus = () => {\r\n        //проверка страницы, если страница пользователя, то можно редактировать.\r\n        if (Number(props.urlMatchParams) === props.id) {\r\n            if (!editMode) {\r\n                return <span onDoubleClick={activateEditMode} data-tooltip=\"double click to change\">{!props.status ? <div>_____</div> : props.status}</span>\r\n            } else {\r\n                return <input onChange={onChangeTextStatus} autoFocus={true}\r\n                              onBlur={deactivateEditMode} value={status}/>\r\n            }\r\n        } else {\r\n            //просто вывод\r\n            return <div>\r\n                {!props.status ? <div>_____</div> : props.status}\r\n            </div>\r\n        }\r\n\r\n    }\r\n    return (\r\n        <div>\r\n            {withEditStatus()}\r\n        </div>\r\n    )\r\n})\r\n\r\n\r\nexport default ProfileStatusWithHooks","import s from \"./Profile.module.css\";\r\nimport React from \"react\";\r\n\r\n\r\nconst ProfileData = (props) => {\r\n    return (\r\n        <div className={s.infoProfile}>\r\n            <div className={s.editButton}>\r\n                {props.id === Number(props.urlMatchParams) &&\r\n                    <p className='waves-effect waves-light btn-small indigo lighten-4 black-text mb10' onClick={() => {\r\n                        props.setEditProfile(true)\r\n                    }}>Edit\r\n                </p>\r\n                }\r\n            </div>\r\n            <hr />\r\n            <div className=\"row\">\r\n                <div className=\"col s6\">\r\n                    <b>About me: </b>\r\n                </div>\r\n                <div className=\"col s6 right-align\">\r\n                    <p>{props.profile.aboutMe}</p>\r\n                </div>\r\n            </div>\r\n            <div className=\"row\">\r\n                <div className=\"col s6\">\r\n                    <b>Full name: </b>\r\n                </div>\r\n                <div className=\"col s6 right-align\">\r\n                    <p>{props.profile.fullName}</p>\r\n                </div>\r\n            </div>\r\n            <div className=\"row\">\r\n                <div className=\"col s6\">\r\n                    <b>Status:</b>\r\n                </div>\r\n                <div className=\"col s6 right-align\">\r\n                    <p>{props.status}</p>\r\n                </div>\r\n            </div>\r\n            <div className=\"row\">\r\n                <div className=\"col s6\">\r\n                    <b>Seek work: </b>\r\n                </div>\r\n                <div className=\"col s6 right-align\">\r\n                    <p>{props.profile.lookingForAJob ? 'yes' : 'no'}</p>\r\n                </div>\r\n            </div>\r\n            <div className=\"row\">\r\n                <div className=\"col s6\">\r\n                    <b>Description of the search: </b>\r\n                </div>\r\n                <div className=\"col s6 right-align\">\r\n                    <p>{props.profile.lookingForAJobDescription}</p>\r\n                </div>\r\n            </div>\r\n            {Object.keys(props.profile.contacts).map(key =>\r\n                <Contact key={key} contactTitle={key} contactBody={props.profile.contacts[key]} />\r\n            )}\r\n        </div>\r\n    )\r\n}\r\nconst Contact = ({ contactTitle, contactBody }) => {\r\n    return (\r\n        <div>\r\n            {!!contactBody &&\r\n                <div className=\"row\">\r\n                    <div className=\"col s6\">\r\n                        <b>{contactTitle}: </b>\r\n                    </div>\r\n                    <div className=\"col s6 right-align\">\r\n                        <a href={contactBody} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                            {contactBody}\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            }\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default ProfileData;","import React, { useState } from 'react';\r\nimport Preloader from \"../../assets/preloader/Preloader\";\r\nimport s from './Profile.module.css';\r\nimport ReduxEditProfile from \"./ProfileDataForm\";\r\n\r\nimport userPhoto from './../../assets/images/userPhoto.png'\r\nimport ProfileStatusWithHooks from \"./ProfileStatusWithHooks\";\r\nimport ProfileData from \"./ProfileData\";\r\n\r\nconst Profile = React.memo(props => {\r\n    if (!props.profile) {\r\n        return <Preloader />\r\n    }\r\n    let [editProfile, setEditProfile] = useState(false);\r\n    //update profile\r\n    const onSubmit = (formData) => {\r\n        if (formData === props.profile) {\r\n            setEditProfile(false)\r\n        } else {\r\n            props.updateProfileUserThunk(formData).then(() => {\r\n                setEditProfile(false)\r\n            })\r\n        }\r\n    }\r\n    //upload photo\r\n    let onUploadNewPhoto = (e) => {\r\n        if (e.target.files.length) {\r\n            props.uploadNewPhotoThunk(e.target.files[0])\r\n        }\r\n    }\r\n    return (\r\n        <div className={s.profileContain}>\r\n            {props.loading ? <Preloader /> :\r\n                <>\r\n                    <div className='row profile'>\r\n                        <div className=\"col\">\r\n                            <div className={s.avatarBlock}>\r\n                                <img src={!props.profile.photos.small ? userPhoto : props.profile.photos.large} alt='' />\r\n                                {props.id === Number(props.urlMatchParams) &&\r\n                                    // upload photo for myProfile\r\n                                    <div>\r\n                                        <input type=\"file\" name=\"myFile\" id=\"myFile\" onChange={onUploadNewPhoto} />\r\n                                        <label htmlFor=\"myFile\" className={s.uploadPhoto}\r\n                                            data-tooltip=\"click to upload a photo\"> </label>\r\n                                    </div>\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"col s6\">\r\n                            <h5>{props.profile.fullName}</h5>\r\n                            <ProfileStatusWithHooks status={props.status}\r\n                                updateStatusUserThunk={props.updateStatusUserThunk}\r\n                                id={props.id}\r\n                                urlMatchParams={props.urlMatchParams} />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"row profile\">\r\n                        <div className=\"col s12\">\r\n                            {editProfile ?\r\n                                <ReduxEditProfile initialValues={props.profile} onSubmit={onSubmit} profile={props.profile} />\r\n                                :\r\n                                <ProfileData profile={props.profile}\r\n                                    status={props.status}\r\n                                    updateStatusUserThunk={props.updateStatusUserThunk}\r\n                                    id={props.id}\r\n                                    urlMatchParams={props.urlMatchParams}\r\n                                    setEditProfile={setEditProfile}\r\n                                />\r\n                            }\r\n                        </div>\r\n                    </div>\r\n\r\n                </>\r\n            }\r\n        </div>\r\n    )\r\n})\r\n\r\nexport default Profile\r\n","import {ProfileAPI} from \"../Api/Api\";\r\nimport {stopSubmit} from \"redux-form\";\r\n\r\nconst SET_USER_PROFILE = 'SET_USER_PROFILE';\r\nconst SET_STATUS = 'SET_STATUS';\r\nconst SET_NEW_PHOTO = 'SET_NEW_PHOTO'\r\nconst SET_SUCCESS_LOADING = 'SET_SUCCESS_LOADING'\r\n\r\nlet initialState = {\r\n    profile: null,\r\n    status: \"\",\r\n    loading: false\r\n}\r\n\r\nconst profilePageReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case SET_USER_PROFILE:\r\n            return {\r\n                ...state,\r\n                profile: action.profile\r\n            }\r\n        case SET_STATUS:\r\n            return {\r\n                ...state,\r\n                status: action.status\r\n            }\r\n        case SET_NEW_PHOTO:\r\n            return {\r\n                ...state,\r\n                profile: {...state.profile, photos:action.photos}\r\n            }\r\n        case SET_SUCCESS_LOADING:\r\n            return{\r\n                ...state,\r\n                loading: action.loading\r\n        }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\nexport const setUserProfileAC = (profile) => {\r\n    return {\r\n        type: SET_USER_PROFILE, profile\r\n    }\r\n}\r\nexport const setStatusUserAC = (status) => {\r\n    return {\r\n        type: SET_STATUS, status\r\n    }\r\n}\r\nexport const uploadNewPhotoAC = (photos) => {\r\n    return {\r\n        type: SET_NEW_PHOTO, photos\r\n    }\r\n}\r\nexport const setLoadingAC = (loading) => {\r\n    return{\r\n        type: SET_SUCCESS_LOADING, loading\r\n    }\r\n}\r\nexport const getProfileThunkCreator = (userId) => {\r\n    return (dispatch) => {\r\n        if (!userId) {\r\n            //none\r\n        } else {\r\n            ProfileAPI.getProfile(userId)\r\n                .then(response => {\r\n                    dispatch(setUserProfileAC(response.data));\r\n                })\r\n        }\r\n    }\r\n}\r\n//получение статуса пользователя\r\nexport const setStatusUserThunkCreator = (userId) => {\r\n    return (dispatch) => {\r\n        if (!userId) {\r\n            //none\r\n        } else {\r\n            ProfileAPI.getStatus(userId).then(response => {\r\n                dispatch(setStatusUserAC(response.data))\r\n            })\r\n        }\r\n    }\r\n}\r\nexport const updateStatusUserThunkCreator = (userId, newStatus) => {\r\n    return (dispatch) => {\r\n        //проверка на изменение входящего текста\r\n        ProfileAPI.getStatus(userId).then(response => {\r\n            dispatch(setStatusUserAC(response.data))\r\n            if (!newStatus) {\r\n                alert('field empty')\r\n            } else {\r\n                if (response.data !== newStatus) {\r\n                    dispatch(setLoadingAC(true));\r\n                    ProfileAPI.updateStatus(newStatus).then(response => {\r\n                        if (response.data.resultCode === 0) {\r\n                            dispatch(setStatusUserAC(newStatus))\r\n                            dispatch(setLoadingAC(false));\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        })\r\n        //end\r\n    }\r\n}\r\nexport const updateProfileUserThunkCreator = (profile) => (dispatch, getState) => {\r\n    return ProfileAPI.updateProfile(profile).then(response => {\r\n        if (response.data.resultCode === 0) {\r\n            const userId = getState().Auth.id;\r\n            dispatch(getProfileThunkCreator(userId));\r\n        } else {\r\n            let messageError = response.data.messages.length > 0 ? response.data.messages[0] : \"Some error\";\r\n            dispatch(stopSubmit(\"editProfile\", {_error: messageError}))\r\n            return Promise.reject(response.data.messages[0]);\r\n        }\r\n    })\r\n\r\n}\r\n\r\nexport const uploadNewPhotoThunkCreator = (photos) => async(dispatch) => {\r\n    dispatch(setLoadingAC(true));\r\n    let response =  await ProfileAPI.uploadPhoto(photos)\r\n    dispatch(setLoadingAC(false));\r\n    if(response.data.resultCode === 0){\r\n        dispatch(uploadNewPhotoAC(response.data.data.photos));\r\n    }\r\n}\r\n\r\nexport default profilePageReducer;","import React from 'react';\r\nimport Profile from \"./Profile\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    getProfileThunkCreator,\r\n    setStatusUserThunkCreator,\r\n    setUserProfileAC, updateProfileUserThunkCreator, updateStatusUserThunkCreator, uploadNewPhotoThunkCreator\r\n} from \"../../redux/ProfilePage-Reducer\";\r\nimport {Redirect, withRouter} from \"react-router-dom\";\r\nimport {compose} from \"redux\";\r\n\r\nclass ProfileContainer extends React.Component {\r\n    updateProfile(userId) {\r\n        this.props.getProfileThunk(userId);\r\n        this.props.setStatusUserThunk(userId);\r\n    }\r\n\r\n    componentDidMount() {\r\n        //Установка профиля пользователя\r\n        //проверяем из url пользователя по параметрам\r\n        let userId = this.props.match.params.userId;\r\n        this.updateProfile(userId);\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        //обновление профилей при смене url\r\n        if (this.props.match.params.userId !== prevProps.match.params.userId) {\r\n            this.updateProfile(this.props.match.params.userId);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        //добавление url\r\n        if (!this.props.match.params.userId) {\r\n            if (!this.props.id) {\r\n                return <Redirect to={'/login'}/>\r\n            } else {\r\n                let path = `/profile/${this.props.id}`;\r\n                return <Redirect to={path}/>\r\n            }\r\n        }\r\n        return (\r\n                <Profile profile={this.props.profile} status={this.props.status}\r\n                         updateStatusUserThunk={this.props.updateStatusUserThunk}\r\n                         id={this.props.id}\r\n                    //math params для изменения статуса\r\n                         urlMatchParams={this.props.match.params.userId}\r\n                         updateProfileUserThunk={this.props.updateProfileUserThunk}\r\n                         uploadNewPhotoThunk={this.props.uploadNewPhotoThunk}\r\n                         loading={this.props.loading}\r\n                />\r\n        )\r\n    }\r\n}\r\n\r\nlet mapStateToProps = (state) => {\r\n    return {\r\n        profile: state.profilePage.profile,\r\n        id: state.Auth.id,\r\n        status: state.profilePage.status,\r\n        loading: state.profilePage.loading\r\n    }\r\n}\r\n\r\n\r\nexport default compose(\r\n    connect(mapStateToProps,\r\n        {\r\n            setUser: setUserProfileAC,\r\n            getProfileThunk: getProfileThunkCreator,\r\n            setStatusUserThunk: setStatusUserThunkCreator,\r\n            updateStatusUserThunk: updateStatusUserThunkCreator,\r\n            updateProfileUserThunk: updateProfileUserThunkCreator,\r\n            uploadNewPhotoThunk: uploadNewPhotoThunkCreator\r\n        }),\r\n    //withAuthRedirectHoc,\r\n    withRouter\r\n)(ProfileContainer)\r\n","import React from 'react';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport s from './Sidebar.module.css';\r\n\r\nconst Sidebar = (props) => {\r\n    return (\r\n        <div className={s.sidebar}>\r\n            <ul>\r\n                <li>\r\n                    <NavLink to='/profile/' activeClassName={s.active}> Profile </NavLink><br />\r\n                </li>\r\n                <li>\r\n                    <NavLink to='/Dialogs' activeClassName={s.active}> Dialogs </NavLink><br />\r\n                </li>\r\n                <li>\r\n                    <NavLink to='/Users' activeClassName={s.active}> Users </NavLink><br />\r\n                </li>\r\n                <li>\r\n                    <button onClick={props.logoutThunk} className={s.loginButton}>\r\n                        Log out\r\n                </button>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Sidebar;\r\n","import React from 'react';\r\nimport Sidebar from './../Sidebar/SIdebar';\r\n\r\nconst DropDownNavbar = (props) => {\r\n    let addClassForToggle = props.toggle ? ' active' : '';\r\n    return (\r\n        <div className=\"container blockDrop\">\r\n            <div className={'dropdownMenu' + addClassForToggle }>\r\n                <Sidebar logoutThunk={props.logoutThunk} />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default DropDownNavbar","import React from 'react';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport './../../App.css';\r\nimport s from './Header.module.css';\r\nimport userPhoto from './../../assets/images/userPhoto.png'\r\nimport DropDownNavbar from './DropDownNavbar';\r\n\r\n\r\nconst Header = (props) => {\r\n    let getUserPhoto = () => {\r\n        return !props.userPhoto ? <img src={userPhoto} alt='' className={s.userPhoto} /> :\r\n            <img src={props.userPhoto.small} alt='' className={s.userPhoto} /> || <img src={props.userPhoto.large} alt={''} className={s.userPhoto} />;\r\n    }\r\n    return (\r\n        <>\r\n            <nav className={'grey darken-4'}>\r\n                <div className=\"nav-wrapper\">\r\n                    <div className=\"container\">\r\n                        {/* <a href=\"/\" className=\"brand-logo\"></a> */}\r\n                        <ul className={\"right \" + s.cursor} onClick={() => { props.dropDownToogle() }}>\r\n                            {props.isAuth ?\r\n                                <>\r\n                                    <li><h5>{props.login}</h5></li>\r\n                                    <p to='/profile' className={s.userlink}>\r\n                                        <li className='btn-floating btn-large waves-effect waves-light grey darken-4'>\r\n                                            {getUserPhoto()}\r\n                                        </li>\r\n                                    </p>\r\n                                    <li>\r\n                                        <i className=\"small material-icons\">expand_more</i>\r\n                                    </li>\r\n                                </>\r\n                                :\r\n                                <button className={s.loginButton}>\r\n                                    <NavLink to='/login/'>\r\n                                        Login\r\n                                    </NavLink>\r\n                                </button>\r\n                            }\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n            </nav>\r\n            {props.isAuth && <DropDownNavbar logoutThunk={props.logoutThunk} toggle={props.toggle} />}\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Header;","import { meAPI, securityAPI } from \"../Api/Api\";\r\nimport { stopSubmit } from \"redux-form\";\r\n\r\nconst SET_AUTH_USER = 'SET_AUTH_USER';\r\nconst SET_SUCCESS_CAPTCHA = 'SET_SUCCESS_CAPTCHA';\r\nconst TOOGLE_LOADING = 'TOOGLE_LOADING';\r\n//длинная запись\r\n// type InitialStateType2 = {\r\n//     id: number | null\r\n//     login: string | null\r\n//     email: string | null\r\n//     isAuth: boolean \r\n//     captcha: string | null\r\n// }\r\ntype InitialStateType = typeof initialState;\r\nlet initialState = {\r\n    id: null as number | null,\r\n    login: null as string | null,\r\n    email: null as string | null,\r\n    isAuth: false,\r\n    captcha: null as string | null,\r\n    loading: false\r\n}\r\n//коротая запись установки типа, автоматически\r\n//но указав as, даем понятие четкого типа\r\n\r\n\r\nconst authReducer = (state = initialState, action: any): InitialStateType => {\r\n    switch (action.type) {\r\n        case SET_AUTH_USER:\r\n        case SET_SUCCESS_CAPTCHA:\r\n            return {\r\n                ...state,\r\n                ...action.data\r\n            }\r\n        case TOOGLE_LOADING: \r\n        return{\r\n            ...state,\r\n            loading: action.loading\r\n        }\r\n        default:\r\n            return state\r\n    }\r\n}\r\ntype DataSetAuthUserACType = {\r\n    id: number | null\r\n    login: string | null\r\n    email: string | null\r\n    isAuth: boolean\r\n}\r\ntype SetAuthUserACType = {\r\n    type: typeof SET_AUTH_USER,\r\n    data: DataSetAuthUserACType\r\n}\r\n\r\nexport const setAuthUserAC =\r\n    (id: number | null, login: string | null, email: string | null, isAuth: boolean): SetAuthUserACType => {\r\n        return {\r\n            type: SET_AUTH_USER,\r\n            data: { id, login, email, isAuth }\r\n        }\r\n    }\r\n\r\ntype SetSuccessCaptchaACType = {\r\n    type: typeof SET_SUCCESS_CAPTCHA,\r\n    data: {\r\n        captcha: string\r\n    }\r\n}\r\ntype ToogleLoadingACType = {\r\n    type: typeof TOOGLE_LOADING,\r\n    loading: boolean\r\n}\r\nexport const toogleLoadingAC = (loading: boolean): ToogleLoadingACType => {\r\n    return {\r\n        type: TOOGLE_LOADING,\r\n        loading\r\n    }\r\n}\r\nexport const setSuccessCaptchaAC = (captcha: string): SetSuccessCaptchaACType => {\r\n    return {\r\n        type: SET_SUCCESS_CAPTCHA,\r\n        data: { captcha }\r\n    }\r\n}\r\n\r\ntype AuthMeThunkCreatorType = {\r\n    response: {}\r\n    data: {\r\n        resultCode: number;\r\n        data: {\r\n            id: number;\r\n            login: string;\r\n            email: string\r\n        }\r\n    }\r\n}\r\nexport const authMeThunkCreator = () => (dispatch: any) => {\r\n    dispatch(toogleLoadingAC(true));\r\n    return meAPI.me().then((response: AuthMeThunkCreatorType) => {\r\n        if (response.data.resultCode === 0) {\r\n            let { id, login, email } = response.data.data;\r\n            dispatch(setAuthUserAC(id, login, email, true))\r\n            dispatch(toogleLoadingAC(false));\r\n        }else{\r\n            dispatch(toogleLoadingAC(false));\r\n        }\r\n    })\r\n}\r\ntype loginThunkCreatorType = {\r\n    response: {}\r\n    data: {\r\n        resultCode: number;\r\n        messages: string[]\r\n    }\r\n}\r\nexport const loginThunkCreator = (email: string, password: string, rememberMe: boolean, captcha: string) => (dispatch: any) => {\r\n    dispatch(toogleLoadingAC(true));\r\n    meAPI.login(email, password, rememberMe, captcha).then((response: loginThunkCreatorType) => {\r\n        if (response.data.resultCode === 0) {\r\n            dispatch(authMeThunkCreator())\r\n            dispatch(toogleLoadingAC(false));\r\n        } else {\r\n            if (response.data.resultCode === 10) {\r\n                dispatch(getCaptchaThunkCreator());\r\n                dispatch(toogleLoadingAC(false));\r\n            }\r\n            let messageError = response.data.messages.length > 0 ? response.data.messages[0] : \"Some error\";\r\n            dispatch(stopSubmit(\"login\", { _error: messageError }))\r\n            dispatch(toogleLoadingAC(false));\r\n        }\r\n    })\r\n}\r\ntype LogoutThunkCreatorType = {\r\n    response: {};\r\n    data: {\r\n        resultCode: number\r\n    }\r\n}\r\nexport const logoutThunkCreator = () => (dispatch: any) => {\r\n    dispatch(toogleLoadingAC(true));\r\n    meAPI.logout().then((response: LogoutThunkCreatorType) => {\r\n        if (response.data.resultCode === 0) {\r\n            dispatch(setAuthUserAC(null, null, null, false))\r\n            dispatch(toogleLoadingAC(false));\r\n        }else{\r\n            dispatch(toogleLoadingAC(false));\r\n        }\r\n    })\r\n}\r\nexport const getCaptchaThunkCreator = () => async (dispatch: any) => {\r\n    dispatch(toogleLoadingAC(true));\r\n    let response = await securityAPI.getCaptcha();\r\n    dispatch(setSuccessCaptchaAC(response.data.url))\r\n    dispatch(toogleLoadingAC(false));\r\n}\r\n\r\nexport default authReducer;","import {authMeThunkCreator} from \"./Auth-Reducer\";\r\nimport {ProfileAPI} from \"../Api/Api\";\r\n\r\nconst INITIALIZED_SUCCESS = 'INITIALIZED_SUCCESS';\r\nconst INITIALIZED_USER_PHOTO = 'INITIALIZED_USER_PHOTO';\r\n\r\ntype IinitialStateType = {\r\n    initialized: boolean,\r\n    userPhoto: null\r\n}\r\nlet initialState:IinitialStateType = {\r\n    initialized: false,\r\n    userPhoto: null\r\n}\r\n\r\nexport const appReducer = (state = initialState, action: any):IinitialStateType => {\r\n    switch (action.type) {\r\n        case INITIALIZED_SUCCESS:\r\n            return {\r\n                ...state,\r\n                initialized: true\r\n            }\r\n        case INITIALIZED_USER_PHOTO:\r\n            return{\r\n                ...state,\r\n                userPhoto: {...action.userPhoto}\r\n            }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\ntype InitializedSuccessACType = {\r\n    type: typeof INITIALIZED_SUCCESS\r\n}\r\n\r\nexport const initializedSuccessAC = ():InitializedSuccessACType => {\r\n    return{\r\n        type: INITIALIZED_SUCCESS\r\n    }\r\n}\r\nexport const initializedUserPhotoAC = (userPhoto: any) => {\r\n    return{\r\n        type: INITIALIZED_USER_PHOTO,\r\n        userPhoto\r\n    }\r\n}\r\n\r\nexport const initiliazedThunkCreator = () => (dispatch: any) => {\r\n    let promise = dispatch(authMeThunkCreator());\r\n    promise.then(() => {\r\n        dispatch(initializedSuccessAC());\r\n    })\r\n}\r\nexport const initiliazedUserPhotoThunkCreator = (userId : any) => async(dispatch : any) => {\r\n    if(!userId){\r\n        //none\r\n    }else {\r\n        let promise = await ProfileAPI.getProfile(userId);\r\n        dispatch(initializedUserPhotoAC(promise.data.photos));\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport Header from \"./Header\";\r\nimport { connect } from \"react-redux\";\r\nimport { logoutThunkCreator } from \"../../redux/Auth-Reducer\";\r\nimport { initiliazedUserPhotoThunkCreator } from \"../../redux/App-Reducer\";\r\nimport { withRouter } from 'react-router-dom';\r\nimport { compose } from 'redux';\r\n\r\n\r\nclass HeaderContainer extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { toggle: false };\r\n    }\r\n    dropDownToogle() {\r\n        this.setState({\r\n            toggle: !this.state.toggle\r\n        });\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.initiliazedUserPhotoThunk(this.props.id);\r\n    }\r\n    //when changing accounts, the avatar does not change, correction\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if (prevProps.id !== this.props.id) {\r\n            if (this.props.id === null) {\r\n                //none\r\n            } else {\r\n                this.props.initiliazedUserPhotoThunk(this.props.id);\r\n            }\r\n        }\r\n        if (prevProps.location.pathname !== this.props.location.pathname) {\r\n            this.setState({\r\n                toggle: false\r\n            });\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Header {...this.props} userPhoto={this.props.userPhoto} dropDownToogle={this.dropDownToogle.bind(this)}\r\n                toggle={this.state.toggle}\r\n            />\r\n        )\r\n    }\r\n}\r\nlet mapStateToProps = (state) => {\r\n    return {\r\n        isAuth: state.Auth.isAuth,\r\n        login: state.Auth.login,\r\n        id: state.Auth.id,\r\n        userPhoto: state.app.userPhoto\r\n    }\r\n}\r\n\r\nexport default compose(\r\n    connect(mapStateToProps, {\r\n        logoutThunk: logoutThunkCreator,\r\n        initiliazedUserPhotoThunk: initiliazedUserPhotoThunkCreator\r\n    }),\r\n    withRouter)(HeaderContainer);","\r\nexport const required = (value) => {\r\n    if(value) return undefined;\r\n    return 'Some errors';\r\n}\r\n\r\nexport const maxLengthCreator = (maxLength) => (value) => {\r\n    if(value.length > maxLength) return 'Maximum number of characters ' + maxLength;\r\n    return undefined\r\n}\r\n","import React from 'react';\r\nimport { Field, reduxForm } from 'redux-form';\r\nimport { InputAuth } from \"../../assets/FormControl/FormsControls\";\r\nimport { required } from \"../utils/validators/validators\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport s from './../../assets/FormControl/FormsControls.module.css';\r\nimport Preloader from './../../assets/preloader/Preloader';\r\n\r\n//testing validate maxLength\r\n//let maxLength5 = maxLengthCreator(5);\r\n//create local form\r\nconst LoginForm = (props) => {\r\n    return (\r\n        <form onSubmit={props.handleSubmit}>\r\n            <div>\r\n                <Field placeholder='Email' validate={[required]} name='email' component={InputAuth} />\r\n            </div>\r\n            <div>\r\n                <Field placeholder='Password' validate={[required]}\r\n                    name='password' type='Password' component={InputAuth} />\r\n            </div>\r\n            <div>\r\n                <p>\r\n                    <label>\r\n                        <Field name='rememberMe' component=\"input\" type=\"Checkbox\" />\r\n                        <span>Remember Me</span>\r\n                    </label>\r\n                </p>\r\n            </div>\r\n            {props.error && <div className={s.someError}>{props.error}</div>}\r\n            {props.captcha && <div><img src={props.captcha} alt={''} /></div>}\r\n            {props.captcha && <div><Field placeholder='enter symbols' name='captcha' component='input'\r\n                validate={[required]} /></div>}\r\n            <button className='waves-effect waves-light btn-small mr10'>Login</button>\r\n            <a href='https://social-network.samuraijs.com/'\r\n                target='_blank' className='waves-effect waves-light btn-small  deep-purple lighten-1' rel=\"noopener noreferrer\">\r\n                Go to API\r\n                </a>\r\n        </form>\r\n    )\r\n}\r\n//create redux-form\r\nconst ReduxLoginForm = reduxForm({ form: 'login' })(LoginForm)\r\nconst Login = (props) => {\r\n    let onSubmit = (formData) => {\r\n        //авторизация\r\n        props.loginThunk(formData.email, formData.password, formData.rememberMe, formData.captcha)\r\n    }\r\n    if (props.isAuth) {\r\n        return <Redirect to={'/profile'} />\r\n    }\r\n    return (\r\n        <div>\r\n            {props.loading && <Preloader />}\r\n            <div className=\"authBlock\">\r\n                <h3>Login</h3>\r\n                <ReduxLoginForm onSubmit={onSubmit} captcha={props.captcha} />\r\n                <h3>Use to log in:</h3>\r\n                <ul>\r\n                    <li>\r\n                        <h5>\r\n                            Email: free@samuraijs.com\r\n                    </h5>\r\n                    </li>\r\n                    <li>\r\n                        <h5>\r\n                            Password: free\r\n                    </h5>\r\n                    </li>\r\n                </ul>\r\n                <h5>If authorization does not work, do it\r\n                <a href=\"https://social-network.samuraijs.com/login\" target=\"_blank\" rel=\"noopener noreferrer\"> here</a>\r\n                </h5>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Login\r\n","import Login from \"./Login\";\r\nimport {connect} from \"react-redux\";\r\nimport { loginThunkCreator, getCaptchaThunkCreator } from \"../../redux/Auth-Reducer\";\r\n\r\n\r\nlet mapStateToProps = (state) => {\r\n    return {\r\n        isAuth: state.Auth.isAuth,\r\n        captcha: state.Auth.captcha,\r\n        loading: state.Auth.loading\r\n    }\r\n}\r\n\r\nexport const LoginContainer = connect(mapStateToProps, {\r\n    loginThunk: loginThunkCreator,\r\n    getCaptchaThunk: getCaptchaThunkCreator\r\n})(Login)\r\n\r\n","import React from 'react';\r\nimport s from '../Sidebar/Sidebar.module.css';\r\n\r\nconst SecondSidebar = (props) => {\r\n    return(\r\n        <div className={s.sidebar}>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SecondSidebar;\r\n","import React from 'react';\r\nimport { NavLink } from \"react-router-dom\";\r\nimport userPhoto from '../../assets/images/userPhoto.png'\r\n\r\nconst Dialog = (props) => {\r\n    let lastDataActivity = props.dialog.lastDialogActivityDate;\r\n    let lastDataActivShort = lastDataActivity.substr(0, lastDataActivity.length - 12)\r\n    return (\r\n        <div className='dialog'>\r\n            <NavLink to={`/messages/${props.dialog.id}`} className='black-text'>\r\n                <div className=\"row\">\r\n                    <div className=\"col xl1 l1 m2 s3\">\r\n                        <div>\r\n                            {!props.dialog.photos.small || !props.dialog.photos.large ?\r\n                                <img src={userPhoto} alt='' />\r\n                                :\r\n                                <img src={props.dialog.photos.small} alt='' /> || <img src={props.dialog.photos.large} alt='' />\r\n                            }\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"col xl11 l11 m10 s9\">\r\n                        <div className=\"row\">\r\n                            <div className=\"col s6 left-align\">\r\n                                <h5>{props.dialog.userName}</h5>\r\n                            </div>\r\n                            <div className=\"col s6 right-align\">\r\n                                <p className='activity'>\r\n                                    {lastDataActivShort}<br />\r\n                                    {/* {props.dialog.lastUserActivityDate}<br /> */}\r\n                                </p>\r\n                                {props.dialog.newMessagesCount <= 0 ? '' :\r\n                                    <p className=\"newMessage\">\r\n                                        <span>\r\n                                            {props.dialog.newMessagesCount}\r\n                                        </span>\r\n                                    </p>\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </NavLink>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Dialog;","import React from 'react';\r\nimport Dialog from \"./Dialog\";\r\nimport Preloader from \"../../assets/preloader/Preloader\";\r\n\r\nconst Dialogs = (props) => {\r\n    if(props.loading){\r\n        return <Preloader/>\r\n    }\r\n    return(\r\n        <div>\r\n            <div>\r\n                    {props.listDialogs.length === 0 ? <div>No dialogs</div> :\r\n                        props.listDialogs.map(dialog => <Dialog dialog={dialog} key={dialog.id}/>)}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Dialogs;","import { DialogsAPI, ProfileAPI } from \"../Api/Api\";\r\n\r\nconst SET_ALL_DIALOGS = 'SET_ALL_DIALOGS'\r\nconst SET_MESSAGES_WITH_FRIEND = 'SET_MESSAGES_WITH_FRIEND'\r\nconst SET_COUNT_NEW_MESSAGES = 'SET_COUNT_NEW_MESSAGES';\r\nconst SET_CURRENT_USER_IN_CHAT = 'SET_CURRENT_USER_IN_CHAT';\r\nconst SET_SUCCESS_LOADING = 'SET_SUCCESS_LOADING'\r\n\r\n\r\ntype InitialStateType = {\r\n    listDialogs: [];\r\n    messagesWithFriend: {\r\n        items: [],\r\n        totalCount: number | null\r\n    };\r\n    countNesMessages: number | null;\r\n    currentUserInChat: [];\r\n    loading: boolean;\r\n}\r\n\r\nlet initialState: InitialStateType = {\r\n    listDialogs: [],\r\n    messagesWithFriend: {\r\n        items: [],\r\n        totalCount: null\r\n    },\r\n    countNesMessages: null,\r\n    currentUserInChat: [],\r\n    loading: false\r\n}\r\n\r\nconst DialogsReducer = (state = initialState, action: any) => {\r\n    switch (action.type) {\r\n        case SET_ALL_DIALOGS:\r\n            return {\r\n                ...state,\r\n                ...state.listDialogs,\r\n                listDialogs: action.allDialogs\r\n            }\r\n        case SET_MESSAGES_WITH_FRIEND:\r\n            return {\r\n                ...state,\r\n                messagesWithFriend: {\r\n                    ...state.messagesWithFriend,\r\n                    items: action.messages,\r\n                    totalCount: action.totalCount\r\n                },\r\n\r\n            }\r\n        case SET_COUNT_NEW_MESSAGES:\r\n            return {\r\n                ...state,\r\n                countNesMessages: action.countNesMessages\r\n            }\r\n        case SET_CURRENT_USER_IN_CHAT:\r\n            return {\r\n                ...state,\r\n                currentUserInChat: action.profile\r\n            }\r\n        case SET_SUCCESS_LOADING: {\r\n            return {\r\n                ...state,\r\n                loading: action.loading\r\n            }\r\n        }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\ntype SetAllDialogsACType = {\r\n    type: typeof SET_ALL_DIALOGS\r\n    allDialogs: object\r\n}\r\nexport const setAllDialogsAC = (allDialogs: Object): SetAllDialogsACType => {\r\n    return {\r\n        type: SET_ALL_DIALOGS, allDialogs\r\n    }\r\n}\r\ntype SetCountNewMessagesType = {\r\n    type: typeof SET_COUNT_NEW_MESSAGES\r\n    countNesMessages: number\r\n}\r\nexport const setCountNewMessages = (countNesMessages: number): SetCountNewMessagesType => {\r\n    return {\r\n        type: SET_COUNT_NEW_MESSAGES, countNesMessages\r\n    }\r\n}\r\ntype SetCurrentUserInChatACType = {\r\n    type: typeof SET_CURRENT_USER_IN_CHAT\r\n    profile: object\r\n}\r\nexport const setCurrentUserInChatAC = (profile: object): SetCurrentUserInChatACType => {\r\n    return {\r\n        type: SET_CURRENT_USER_IN_CHAT, profile\r\n    }\r\n}\r\n\r\ntype SetMessagesListWithFriendACType = {\r\n    type: typeof SET_MESSAGES_WITH_FRIEND\r\n    messages: object\r\n    totalCount?: number | null\r\n}\r\nexport const setMessagesListWithFriendAC = (messages: object, totalCount?: number):\r\n    SetMessagesListWithFriendACType => {\r\n    return {\r\n        type: SET_MESSAGES_WITH_FRIEND, messages, totalCount\r\n    }\r\n}\r\ntype SetSuccessLoadingACType = {\r\n    type: typeof SET_SUCCESS_LOADING\r\n    loading: boolean\r\n}\r\nexport const setSuccessLoadingAC = (loading: boolean): SetSuccessLoadingACType => {\r\n    return {\r\n        type: SET_SUCCESS_LOADING, loading\r\n    }\r\n}\r\n\r\nexport const startChattingThunkCreator = (userId: number) => async (dispatch: any) => {\r\n    await DialogsAPI.startChatting(userId)\r\n    // console.log('startChatting')\r\n    // console.log(response)\r\n}\r\n\r\nexport const getAllDialogsThunkCreator = () => async (dispatch: any) => {\r\n    dispatch(setSuccessLoadingAC(true));\r\n    let response = await DialogsAPI.getAllDialogs()\r\n    dispatch(setSuccessLoadingAC(false));\r\n    // console.log('getAllDialogs')\r\n    dispatch(setAllDialogsAC(response.data));\r\n    // console.log(response.data)\r\n}\r\n\r\n\r\nexport const getListMessagesWithFriendThunkCreator = (userId: number) => async (dispatch: any) => {\r\n    let response = await DialogsAPI.getListMessagesWithFriend(userId)\r\n    dispatch(setMessagesListWithFriendAC(response.data.items, response.data.totalCount));\r\n    // console.log('getListMessagesWithFriend');\r\n    // console.log(response.data)\r\n    //set current user in chat\r\n    response = await ProfileAPI.getProfile(userId)\r\n    dispatch(setCurrentUserInChatAC(response.data))\r\n    Promise.all([response]).then(values => {\r\n        dispatch(setSuccessLoadingAC(false));\r\n    })\r\n}\r\nexport const syncMessagesWithFrinedThunkCreator = (userId: number) => (dispatch: any) => {\r\n    DialogsAPI.getListMessagesWithFriend(userId).then((response: any) => {\r\n        dispatch(setMessagesListWithFriendAC(response.data.items, response.data.totalCount));\r\n        // console.log('getListMessagesWithFriend');\r\n        // console.log(response.data)\r\n    })\r\n    console.log('sync: User:', userId);\r\n}\r\n\r\nexport const sendMessageToFriendThunkCreator = (userId: number, newMessage: string) => async (dispatch: any) => {\r\n    await DialogsAPI.sendMessageToFriend(userId, newMessage);\r\n    dispatch(getListMessagesWithFriendThunkCreator(userId));\r\n}\r\n\r\nexport const getListNewMessagesThunkCreator = (userId: number) => async (dispatch: any) => {\r\n    let response = await DialogsAPI.listNewMessage();\r\n    dispatch(setCountNewMessages(response.data))\r\n    // console.log('getListNewMessages');\r\n    // console.log(response.data)\r\n}\r\ntype ReponseGetReturnMessageDateThunkCreatorType = {\r\n    response: {}\r\n    data: {\r\n        items: any\r\n        totalCount: number | null\r\n    }\r\n}\r\nexport const getReturnMessageDateThunkCreator = (userId: number, date: string) => async (dispatch: any) => {\r\n    let response: ReponseGetReturnMessageDateThunkCreatorType = await DialogsAPI.returnMessageThanDate(userId, date);\r\n    dispatch(setMessagesListWithFriendAC(response.data));\r\n}\r\n\r\n\r\n\r\nexport default DialogsReducer;","import React, {useEffect} from 'react';\r\nimport Dialogs from \"./Dialogs\";\r\nimport {connect} from \"react-redux\";\r\nimport {\r\n    getAllDialogsThunkCreator,\r\n    getListMessagesWithFriendThunkCreator,\r\n    getListNewMessagesThunkCreator,\r\n    sendMessageToFriendThunkCreator,\r\n    startChattingThunkCreator\r\n} from \"../../redux/Dialogs-Reducer\";\r\nimport {compose} from \"redux\";\r\nimport {Redirect, withRouter} from \"react-router-dom\";\r\n\r\n\r\nconst DialogsContainer = (props) => {\r\n    useEffect(()=>{\r\n        props.getAllDialogsThunk();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    },[])\r\n    if(!props.id){\r\n        return <Redirect to={'/login'}/>\r\n    }\r\n    return(\r\n        <Dialogs {...props}/>\r\n    )\r\n}\r\n\r\n\r\n\r\nlet mapStateToProps = (state) => {\r\n    return {\r\n        listDialogs: state.dialogs.listDialogs,\r\n        messagesWithFriend: state.dialogs.messagesWithFriend,\r\n        countNesMessages: state.dialogs.countNesMessages,\r\n        id: state.Auth.id,\r\n        loading: state.dialogs.loading\r\n    }\r\n}\r\n\r\nexport default compose(\r\n    withRouter,\r\n    connect(mapStateToProps,{\r\n        startChattingThunk:startChattingThunkCreator,\r\n        getAllDialogsThunk: getAllDialogsThunkCreator,\r\n        getListMessagesWithFriendThunk: getListMessagesWithFriendThunkCreator,\r\n        sendMessageToFriendThunk: sendMessageToFriendThunkCreator,\r\n        getListNewMessagesThunk: getListNewMessagesThunkCreator\r\n    })\r\n)(DialogsContainer)\r\n","import React from 'react';\r\nimport { Field, reduxForm } from \"redux-form\";\r\nimport s from './MessagesForm.module.css'\r\n\r\nconst MessageForm = (props) => {\r\n    return (\r\n        <form onSubmit={props.handleSubmit} className={s.container}>\r\n            <div className=\"row p10\">\r\n                <div className=\"col xl11 m10 l10 s10\">\r\n                    <Field name='newMessage' placeholder='Write a message' component='textarea' className=\"materialize-textarea\" />\r\n                </div>\r\n                <div className=\"col xl1 m2 l2 s2 center-align\">\r\n                    <button className='btn-Medium transparent sendMessage pt25'>\r\n                        <i className=\"Medium material-icons black-text\">send</i>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </form>\r\n    )\r\n}\r\n\r\nexport const ReduxMessageForm = reduxForm({ form: 'Message' })(MessageForm)\r\n\r\n","import React from 'react';\r\nimport s from \"./Dialogs.module.css\";\r\nimport { ReduxMessageForm } from \"./MessageForm\";\r\nimport userPhoto from './../../assets/images/userPhoto.png'\r\nimport { NavLink } from \"react-router-dom\";\r\n\r\nconst Messages = (props) => {\r\n    let userId = props.match.params.userId;\r\n    let onTextInMessage = (formData) => {\r\n        props.sendMessageToFriendThunk(userId, formData.newMessage)\r\n    }\r\n\r\n    const regEx = /[^\\d:]/g;\r\n    const addedAt = (date) => {\r\n        let format = date.substr(date.length - 12)\r\n        let result = format.replace(regEx, '')\r\n        return result.split(':')[0] + ':' + result.split(':')[1];\r\n    }\r\n\r\n    //take current user photo\r\n    let getCurrentUserPhoto = props.currentUserInChat.length === 0 ? '' :\r\n        !props.currentUserInChat.photos.large || !props.currentUserInChat.photos.small ?\r\n            <img src={userPhoto} alt={''} /> : <img src={props.currentUserInChat.photos.large} alt={''} />;\r\n    //take auth profile photo\r\n    let getUserPhoto = !props.authUserPhoto ? ' ' :\r\n        <img src={props.authUserPhoto.small} alt={''} /> || <img src={props.authUserPhoto.large} alt={''} />\r\n    return (\r\n        <div className=\"message__main container\">\r\n            <div className=\"row\">\r\n                <div className=\"col s12\">\r\n                    <div className={s.messagesContain}>\r\n                        {props.currentUserInChat.length === 0 ? '' :\r\n                            <div className={s.chatTittle}>\r\n                                <h3 className='left-align'>\r\n                                    <NavLink to='/Dialogs'>\r\n                                        Back\r\n                                    </NavLink>\r\n                                </h3>\r\n                                <h3 className='center-align'>{props.currentUserInChat.fullName}</h3>\r\n                                <NavLink to={'/profile/' + userId}>\r\n                                    {getCurrentUserPhoto}\r\n                                </NavLink>\r\n                            </div>\r\n                        }\r\n                        <div className={s.mainChatBlock}>\r\n                            <div className={s.chatBody}>\r\n                                {props.messagesWithFriend.items.length >= 10 &&\r\n                                    <button className={s.past__messages} onClick={() => {\r\n                                        props.getReturnMessageDateThunk(props.currentUserInChat.userId, '2020.01.01')\r\n                                    }}>\r\n                                        Past messages\r\n                                    </button>\r\n                                }\r\n                                {props.messagesWithFriend.items.length === 0 ? 'You don\\'t have messages with this user' :\r\n                                    props.messagesWithFriend.items.map(m => <div key={m.id} className={m.viewed === true ?\r\n                                        s.messagesWithFriendId : s.notViewedMessage}>\r\n                                        <div className={s.main__img__username}>\r\n                                            {m.senderId === userId ?\r\n                                                getCurrentUserPhoto\r\n                                                :\r\n                                                getUserPhoto\r\n                                            }\r\n                                            <h4>{m.senderName}</h4>\r\n                                            <div className={s.dateAdded}>{addedAt(m.addedAt)}</div>\r\n                                        </div>\r\n                                        {/*<div>Id: {m.id}</div>*/}\r\n                                        {/*check read message*/}\r\n                                        {/*<div>SenderId: {m.senderId}</div>*/}\r\n                                        {/*<div>recipientId: {m.recipientId}</div>*/}\r\n                                        <div className={s.chatText}>{m.body}</div>\r\n                                    </div>)\r\n                                }\r\n                            </div>\r\n                        </div>\r\n                        <ReduxMessageForm onSubmit={onTextInMessage} />\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Messages;","import React from 'react';\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n    getListMessagesWithFriendThunkCreator, getReturnMessageDateThunkCreator, sendMessageToFriendThunkCreator,\r\n    syncMessagesWithFrinedThunkCreator\r\n} from \"../../redux/Dialogs-Reducer\";\r\nimport { compose } from \"redux\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport Messages from \"./Messages\";\r\nimport {Redirect} from \"react-router-dom\";\r\n\r\n\r\nclass MessagesContainer extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { load: false };\r\n    }\r\n    componentDidMount() {\r\n        this.props.getListMessagesWithFriendThunk(this.props.match.params.userId);\r\n    }\r\n\r\n    componentDidUpdate(prevProps) {\r\n        this.props.ClearIntreval();\r\n        if (prevProps.match.params.userId !== this.props.match.params.userId) {\r\n            this.props.getListMessagesWithFriendThunk(this.props.match.params.userId);\r\n            this.props.ClearIntreval();\r\n        } else if (prevProps.match.params.userId === this.props.match.params.userId) {\r\n            this.props.SyncInterval(this.props.match.params.userId);\r\n        }\r\n    }\r\n    render() {\r\n        if(!this.props.id){\r\n            return <Redirect to={'/login'}/>\r\n        }\r\n        return (\r\n            <Messages {...this.props} />\r\n        )\r\n    }\r\n}\r\nlet mapStateToProps = (state) => {\r\n    return {\r\n        messagesWithFriend: state.dialogs.messagesWithFriend,\r\n        listDialogs: state.dialogs.listDialogs,\r\n        currentUserInChat: state.dialogs.currentUserInChat,\r\n        authUserPhoto: state.app.userPhoto,\r\n        id: state.Auth.id\r\n    }\r\n}\r\n\r\nexport default compose(\r\n    withRouter,\r\n    connect(mapStateToProps, {\r\n        getListMessagesWithFriendThunk: getListMessagesWithFriendThunkCreator,\r\n        sendMessageToFriendThunk: sendMessageToFriendThunkCreator,\r\n        getReturnMessageDateThunk: getReturnMessageDateThunkCreator,\r\n        syncMessagesWithFrinedThunk: syncMessagesWithFrinedThunkCreator\r\n    })\r\n)(MessagesContainer)\r\n","import React from 'react';\r\nimport s from './GlobalErrors.module.css'\r\n\r\nclass GlobalErrors extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { globalErrors: null };\r\n    }\r\n    catchAllUnhandelErrors = (promiseRejectionEvent) => {\r\n        // alert(promiseRejectionEvent.reason.message);\r\n        //console.log(promiseRejectionEvent)\r\n        this.setState({\r\n            globalErrors: promiseRejectionEvent.reason.message +\r\n                '(' + promiseRejectionEvent.reason.request.response + ')'\r\n        })\r\n        setTimeout(() =>\r\n            this.setState({\r\n                globalErrors: null\r\n            })\r\n            , 5000)\r\n    }\r\n\r\n    componentDidMount() {\r\n        window.addEventListener(\"unhandledrejection\", this.catchAllUnhandelErrors)\r\n    }\r\n    render() {\r\n        return (\r\n            <>\r\n                {this.state.globalErrors ?\r\n                    <div className={s.error_window}>\r\n                        {this.state.globalErrors}\r\n                    </div>\r\n                    :\r\n                    ''\r\n                }\r\n            </>\r\n        )\r\n    }\r\n}\r\n\r\nexport default GlobalErrors","import React, { Suspense } from 'react';\r\nimport './App.css';\r\nimport { Route } from \"react-router\";\r\nimport ProfileContainer from \"./Components/Profile/ProfileContainer\";\r\nimport HeaderContainer from \"./Components/Header/HeaderContainer\";\r\nimport { LoginContainer } from \"./Components/Login/LoginContainer\";\r\nimport { connect } from \"react-redux\";\r\nimport { compose } from \"redux\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { initiliazedThunkCreator } from \"./redux/App-Reducer\";\r\nimport Preloader from \"./assets/preloader/Preloader\";\r\nimport SecondSidebar from \"./Components/SecondSidebar/SecondSidebar\";\r\nimport DialogsContainer from \"./Components/Dialogs/DialogsContainer\";\r\nimport MessagesContainer from './Components/Dialogs/MessagesContainer';\r\nimport GlobalErrors from './Components/GlobalErrors/GlobalErrors';\r\nimport { syncMessagesWithFrinedThunkCreator } from './redux/Dialogs-Reducer';\r\nimport { Redirect } from \"react-router-dom\"\r\n//import UsersContainer from \"./Components/Users/UsersContainer\";\r\nconst UsersContainer = React.lazy(() => import('./Components/Users/UsersContainer'));\r\n\r\n\r\nclass App extends React.Component {\r\n    componentDidMount() {\r\n        this.props.initiliazedThunk();\r\n    }\r\n    componentDidUpdate(prevProps) {\r\n        if (prevProps.location.pathname !== this.props.location.pathname) {\r\n            this.ClearIntreval();\r\n        }\r\n    }\r\n    //sync message\r\n    SyncInterval(userIdi) {\r\n        this.timerID = setInterval(() =>\r\n            this.props.syncMessagesWithFrinedThunk(userIdi), 5000);\r\n    }\r\n    ClearIntreval() { return clearInterval(this.timerID) };\r\n    //end\r\n\r\n    render() {\r\n        if (!this.props.initialized) {\r\n            return <Preloader />\r\n        }\r\n        return (\r\n            <div className=\"App\">\r\n                <GlobalErrors />\r\n                <HeaderContainer />\r\n                <div className='container'>\r\n                    <div className='row'>\r\n                        <div className='col s12'>\r\n                            <Route\r\n                                path='/Users'\r\n                                render={() => {\r\n                                    return <Suspense fallback={<Preloader />}>\r\n                                        <UsersContainer />\r\n                                    </Suspense>\r\n                                }\r\n                                } />\r\n                            <Route exact path='/profile/:userId?' render={() => <ProfileContainer />} />\r\n                            <Route path='/Login' render={() => <LoginContainer />} />\r\n                            <Route path='/Dialogs' render={() => this.props.id ? <DialogsContainer /> : <Redirect to='/Login' />} />\r\n                            <SecondSidebar />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"container-fluid fluidToMobile\">\r\n                    <Route path='/messages/:userId?' render={() => this.props.id ?\r\n                        <MessagesContainer SyncInterval={this.SyncInterval.bind(this)}\r\n                            ClearIntreval={this.ClearIntreval.bind(this)}\r\n                        /> : <Redirect to='/Login' />} />\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nlet mapStateToProps = (state) => ({\r\n    initialized: state.app.initialized,\r\n    id: state.Auth.id\r\n})\r\n\r\nexport default compose(\r\n    connect(mapStateToProps, {\r\n        initiliazedThunk: initiliazedThunkCreator,\r\n        syncMessagesWithFrinedThunk: syncMessagesWithFrinedThunkCreator\r\n\r\n    }),\r\n    withRouter\r\n)(App)\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n    window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n        /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n    if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n        // The URL constructor is available in all browsers that support SW.\r\n        const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n        if (publicUrl.origin !== window.location.origin) {\r\n            // Our service worker won't work if PUBLIC_URL is on a different origin\r\n            // from what our page is served on. This might happen if a CDN is used to\r\n            // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n            return;\r\n        }\r\n\r\n        window.addEventListener('load', () => {\r\n            const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n            if (isLocalhost) {\r\n                // This is running on localhost. Let's check if a service worker still exists or not.\r\n                checkValidServiceWorker(swUrl, config);\r\n\r\n                // Add some additional logging to localhost, pointing developers to the\r\n                // service worker/PWA documentation.\r\n                navigator.serviceWorker.ready.then(() => {\r\n                    console.log(\r\n                        'This web app is being served cache-first by a service ' +\r\n                        'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n                    );\r\n                });\r\n            } else {\r\n                // Is not localhost. Just register service worker\r\n                registerValidSW(swUrl, config);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n    navigator.serviceWorker\r\n        .register(swUrl)\r\n        .then(registration => {\r\n            registration.onupdatefound = () => {\r\n                const installingWorker = registration.installing;\r\n                if (installingWorker == null) {\r\n                    return;\r\n                }\r\n                installingWorker.onstatechange = () => {\r\n                    if (installingWorker.state === 'installed') {\r\n                        if (navigator.serviceWorker.controller) {\r\n                            // At this point, the updated precached content has been fetched,\r\n                            // but the previous service worker will still serve the older\r\n                            // content until all client tabs are closed.\r\n                            console.log(\r\n                                'New content is available and will be used when all ' +\r\n                                'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n                            );\r\n\r\n                            // Execute callback\r\n                            if (config && config.onUpdate) {\r\n                                config.onUpdate(registration);\r\n                            }\r\n                        } else {\r\n                            // At this point, everything has been precached.\r\n                            // It's the perfect time to display a\r\n                            // \"Content is cached for offline use.\" message.\r\n                            console.log('Content is cached for offline use.');\r\n\r\n                            // Execute callback\r\n                            if (config && config.onSuccess) {\r\n                                config.onSuccess(registration);\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n            };\r\n        })\r\n        .catch(error => {\r\n            console.error('Error during service worker registration:', error);\r\n        });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n    // Check if the service worker can be found. If it can't reload the page.\r\n    fetch(swUrl, {\r\n        headers: {'Service-Worker': 'script'}\r\n    })\r\n        .then(response => {\r\n            // Ensure service worker exists, and that we really are getting a JS file.\r\n            const contentType = response.headers.get('content-type');\r\n            if (\r\n                response.status === 404 ||\r\n                (contentType != null && contentType.indexOf('javascript') === -1)\r\n            ) {\r\n                // No service worker found. Probably a different app. Reload the page.\r\n                navigator.serviceWorker.ready.then(registration => {\r\n                    registration.unregister().then(() => {\r\n                        window.location.reload();\r\n                    });\r\n                });\r\n            } else {\r\n                // Service worker found. Proceed as normal.\r\n                registerValidSW(swUrl, config);\r\n            }\r\n        })\r\n        .catch(() => {\r\n            console.log(\r\n                'No internet connection found. App is running in offline mode.'\r\n            );\r\n        });\r\n}\r\n\r\nexport function unregister() {\r\n    if ('serviceWorker' in navigator) {\r\n        navigator.serviceWorker.ready.then(registration => {\r\n            registration.unregister();\r\n        });\r\n    }\r\n}\r\n","import {applyMiddleware, combineReducers, compose, createStore} from \"redux\";\r\nimport UsersPageReducer from \"./UsersPage-Reducer\";\r\nimport profilePageReducer from \"./ProfilePage-Reducer\";\r\nimport thunkMiddleware from \"redux-thunk\";\r\nimport { reducer as formReducer } from 'redux-form'\r\nimport DialogsReducer from \"./Dialogs-Reducer\";\r\nimport { appReducer } from \"./App-Reducer\";\r\nimport authReducer from \"./Auth-Reducer\";\r\n\r\n\r\nlet reducers = combineReducers({\r\n    userPage: UsersPageReducer,\r\n    profilePage: profilePageReducer,\r\n    Auth: authReducer,\r\n    form: formReducer,\r\n    app: appReducer,\r\n    dialogs: DialogsReducer\r\n})\r\n\r\n//extension\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\nconst store = createStore(reducers,composeEnhancers(\r\n    applyMiddleware(thunkMiddleware)\r\n));\r\n\r\n// let store = createStore(reducers,applyMiddleware(thunkMiddleware));\r\n\r\nwindow.store = store;\r\n\r\nexport default store;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport store from \"./redux/store-redux\";\r\nimport { Provider } from \"react-redux\";\r\nimport { HashRouter } from \"react-router-dom\";\r\nimport 'materialize-css';\r\nimport 'materialize-css/dist/css/materialize.min.css';\r\n\r\n\r\n\r\nReactDOM.render(\r\n    <HashRouter basename={process.env.PUBLIC_URL}>\r\n        <Provider\r\n            store={store} >\r\n            <App />\r\n        </Provider>\r\n    </HashRouter>\r\n    , document.getElementById('root')\r\n);\r\n\r\n//Убрали наш render() так как connect решает эту проблему сам\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"uploadPhoto\":\"Profile_uploadPhoto__cSgFt\",\"infoProfile\":\"Profile_infoProfile__3r0mc\",\"avatarBlock\":\"Profile_avatarBlock__9ZEi-\",\"editButton\":\"Profile_editButton__3_Uta\",\"saveButton\":\"Profile_saveButton__140UJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"FormControl\":\"FormsControls_FormControl__2qXua\",\"error\":\"FormsControls_error__1vYY8\",\"someError\":\"FormsControls_someError__2WXnf\"};","module.exports = __webpack_public_path__ + \"static/media/userPhoto.a8d8ecba.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sidebar\":\"Sidebar_sidebar__1k2CN\",\"active\":\"Sidebar_active__M0-Ej\",\"loginButton\":\"Sidebar_loginButton__mtp_z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loginButton\":\"Header_loginButton__22GjW\",\"cursor\":\"Header_cursor__VdsFJ\",\"userPhoto\":\"Header_userPhoto__3UOb7\",\"userlink\":\"Header_userlink__34Tsc\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"preloader\":\"preloader_preloader__v54Zr\",\"preloadContain\":\"preloader_preloadContain__2re8h\"};","import * as axios from \"axios\";\r\n//создаем образец, чтобы не дублировать код\r\nlet instance = axios.create({\r\n        withCredentials: true,\r\n        baseURL: 'https://social-network.samuraijs.com/api/1.0/',\r\n        headers: {\r\n            \"API-KEY\": \"a6c20467-1a5b-406b-88d2-a8a4879b1b99\"\r\n        }\r\n    })\r\n    //группировка методов\r\nexport const UsersAPI = {\r\n    getUsers(pageSize, pageNumber) {\r\n        return instance.get(`users?count=${pageSize}&page=${pageNumber}`)\r\n            .then(response => {\r\n                return response.data\r\n            })\r\n    },\r\n    getUsersTerm(pageSize, text) {\r\n        return instance.get(`users?count=${pageSize}&page=1&term=${text}`)\r\n            .then(response => {\r\n                return response.data\r\n            })\r\n    }\r\n}\r\n\r\nexport const ProfileAPI = {\r\n    getProfile(userId) {\r\n        return instance.get(`profile/` + userId)\r\n    },\r\n    getStatus(userId) {\r\n        return instance.get(`/profile/status/` + userId);\r\n    },\r\n    updateStatus(newStatus) {\r\n        return instance.put(`/profile/status`, { status: newStatus })\r\n    },\r\n    updateProfile(profile) {\r\n        return instance.put(`/profile`, profile)\r\n    },\r\n    uploadPhoto(photos) {\r\n        const formData = new FormData();\r\n        formData.append(\"image\", photos);\r\n        return instance.put(`profile/photo`, formData, {\r\n            headers: {\r\n                'Content-Type': 'multipart/form-data'\r\n            }\r\n        })\r\n\r\n    }\r\n\r\n}\r\n\r\nexport const FollowAPI = {\r\n    followUser(id) {\r\n        return instance.post(`follow/${id}`, {})\r\n    },\r\n    unfollowUser(id) {\r\n        return instance.delete(`follow/${id}`, {})\r\n    }\r\n}\r\n\r\nexport const meAPI = {\r\n    me() {\r\n        return instance.get(`auth/me`)\r\n    },\r\n    login(email, password, rememberMe = false, captcha = null) {\r\n        return instance.post(`auth/login`, { email, password, rememberMe, captcha })\r\n    },\r\n    logout() {\r\n        return instance.delete(`auth/login`)\r\n    }\r\n}\r\n\r\nexport const securityAPI = {\r\n    getCaptcha() {\r\n        return instance.get(`security/get-captcha-url`)\r\n    }\r\n}\r\n\r\nexport const DialogsAPI = {\r\n    startChatting(userId) {\r\n        return instance.put(`dialogs/${userId}`)\r\n    },\r\n    getAllDialogs() {\r\n        return instance.get(`dialogs`)\r\n    },\r\n    getListMessagesWithFriend(userId) {\r\n        return instance.get(`dialogs/${userId}/messages`)\r\n    },\r\n    sendMessageToFriend(userId, newMessage) {\r\n        return instance.post(`dialogs/${userId}/messages`, { body: newMessage })\r\n    },\r\n    isViewedYourMessage(messageId) {\r\n        return instance.get(`dialogs/messages/${messageId}/viewed`)\r\n    },\r\n    messageInSpam(messageId) {\r\n        return instance.post(`dialogs/messages/${messageId}/spam`)\r\n    },\r\n    deleteMessage(messageId) {\r\n        return instance.delete(`dialogs/messages/${messageId}`)\r\n    },\r\n    restoreMessage(messageId) {\r\n        return instance.put(`dialogs/messages/${messageId}/restore`)\r\n    },\r\n    returnMessageThanDate(userId, date) {\r\n        return instance.get(`dialogs/${userId}/messages/new?newerThen=${date}`)\r\n    },\r\n    listNewMessage() {\r\n        return instance.get(`dialogs/messages/new/count`)\r\n    }\r\n}"],"sourceRoot":""}